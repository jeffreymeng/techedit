<script src="https://www.gstatic.com/firebasejs/3.7.8/firebase.js"></script>

<!-- Firepad -->
<link rel="stylesheet" href="https://cdn.firebase.com/libs/firepad/1.4.0/firepad.css" />
<script src="https://cdn.firebase.com/libs/firepad/1.4.0/firepad.min.js"></script>
<script>
    /* global firebase Firepad*/
    var config = {
        apiKey: "AIzaSyBQ2E4ISQoIcRsDxfPxzDjbJwmD-r98JYw",
        authDomain: "techedit-63e7f.firebaseapp.com",
        databaseURL: "https://techedit-63e7f.firebaseio.com",
        storageBucket: "techedit-63e7f.appspot.com",
        messagingSenderId: "609280907475"
    };
    firebase.initializeApp(config);

    function getQuery(name) {
        var url = window.location.href;
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, " "));
    }

    firebase.initializeApp(config);

    var rootRef = firebase.database().ref("/f/" + getQuery("id"));
    var firepadRef = rootRef.push();
    var headless = new Firepad.Headless(firepadRef);
    headless.getText(function(text) {
        console.log(text);
        document.write(text);
    });
    headless.dispose();
</script>
